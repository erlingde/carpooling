(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{270:function(e,t,n){e.exports=n(558)},275:function(e,t,n){},305:function(e,t){},327:function(e,t){},329:function(e,t){},534:function(e,t,n){},558:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),l=n(9),i=n.n(l),c=(n(275),n(76)),o=n(49),s=n.n(o),d=n(112),h=n(249),u=n(250),f=n(265),m=n(251),p=n(266),v=n(26),g=n(113),E=n.n(g),y=n(562),b=n(563),k=n(248),R=n(247),x=n(13),w=n(246),F=n(561),j=n(252),C=n.n(j),O=n(114),T=n.n(O),I={fetchRideRequests:function(){try{var e=T()("http://apis.is/rides/samferda-drivers/"),t=T()("http://apis.is/rides/samferda-passengers/");return Promise.all([t,e])}catch(n){console.error(n)}},fetchURL:function(e){try{var t=T()("https://cors.io/?".concat(e));return Promise.resolve(t)}catch(n){console.error(n)}}},S=n(253),L=n.n(S),D=function(e){var t=L.a.load(e),n=t("tr:nth-child(6)").children()[1].children[0]?t("tr:nth-child(6)").children()[1].children[0].data:void 0,r=t("tr:nth-child(7)").children()[1].children[0]?t("tr:nth-child(7)").children()[1].children[0].data:void 0,l=t("tr:nth-child(8)").children()[1].children[0]?t("tr:nth-child(8)").children()[1].children[0].data:void 0,i=t("tr:nth-child(9)").children()[1].children[0]?t("tr:nth-child(9)").children()[1].children[0].data:void 0,c=t("tr:nth-child(11)").children()[1].children[0]?t("tr:nth-child(11)").children()[1].children[0].data:void 0,o=t("tr:nth-child(12)").children()[1].children[0]?t("tr:nth-child(12)").children()[1].children[0].data:void 0;return a.a.createElement("div",null,n&&a.a.createElement("p",null,a.a.createElement("b",null,"Seats: "),n),r&&a.a.createElement("p",null,a.a.createElement("b",null,"Name: ")," ",r),l&&a.a.createElement("p",null,a.a.createElement("b",null,"Phone: "),l),i&&a.a.createElement("p",null,a.a.createElement("b",null,"Mobile: "),i),c&&a.a.createElement("p",null,a.a.createElement("b",null,"Non Smoke Car: "),c),o&&a.a.createElement("p",null,a.a.createElement("b",null,"Notes: "),o))},q=n(559),Y=n(560),H=[{title:"From",dataIndex:"from",key:"from"},{title:"To",dataIndex:"to",key:"to"},{title:"Date",key:"date",dataIndex:"date"},{title:function(){return a.a.createElement("span",null,a.a.createElement(R.a,{title:"Time"},a.a.createElement(x.a,{type:"clock-circle"})))},key:"time",dataIndex:"time"},{title:"Details",key:"link",dataIndex:"link",render:function(e,t){return a.a.createElement("span",null,a.a.createElement(q.a,{content:t.details?t.details:a.a.createElement(x.a,{type:"loading",style:{fontSize:16},spin:!0})},a.a.createElement(x.a,{type:"info-circle",style:{fontSize:"18px",color:"red"}})),a.a.createElement(Y.a,{type:"vertical"}),a.a.createElement("a",{href:t.link,rel:"noopener noreferrer",target:"_blank"},"Samfer\xf0a"))}}],M=(n(534),function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(m.a)(t).call(this,e))).populateLocations=function(e,t){return e.forEach(function(e){""===e.from||t.find(function(t){return e.from===t})?""===e.to||t.find(function(t){return e.to===t})||t.push(e.to):t.push(e.from)}),t},n.onRadioChange=function(e){var t=n.state,r=t.fetchedRideRequests,a=t.fetchedPassengerRequests;n.selectedFilterFrom=[],n.selectedFilterTo=[],n.setState({filteredTrips:"ride"===e.target.value?r:a,tripFilter:e.target.value})},n.handleRefreshHoverEnter=function(e){n.state.refreshIconClicked||n.setState({refreshIconHover:!0})},n.handleRefreshHoverLeave=function(e){n.setState({refreshIconHover:!1})},n.handleFilterChange=function(e,t){var r=Object(v.a)(Object(v.a)(n)).filterLocations;"from"===t?n.selectedFilterFrom=e:n.selectedFilterTo=e;var a=r(t);n.setState({filteredTrips:a})},n.handleRefreshClick=function(){var e=n.state.refreshIconClicked,t=Object(v.a)(Object(v.a)(n)).fetchData;e||(n.setState({refreshIconClicked:!0},Object(d.a)(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,setInterval(function(){n.setState({secondsUntilRefresh:--n.refreshTimer}),0===n.refreshTimer&&clearInterval(t)},1e3);case 2:return t=e.sent,e.next=5,setTimeout(function(){n.refreshTimer=5,n.setState({refreshIconClicked:!1,secondsUntilRefresh:5})},5e3);case 5:case"end":return e.stop()}},e,this)}))),t())},n.filterLocations=function(e){var t=n.state,r=t.tripFilter,a=t.fetchedPassengerRequests,l=t.fetchedRideRequests,i=Object(v.a)(Object(v.a)(n)),c=i.selectedFilterFrom,o=i.selectedFilterTo,s=[],d="ride"===r?l:a;return 0===c.length&&0===o.length?"passenger"===r?a:l:(d.forEach(function(e){0!==c.length&&0!==o.length?c.includes(e.from)&&o.includes(e.to)&&s.push(e):(c.includes(e.from)||o.includes(e.to))&&s.push(e)}),s)},n.fetchData=function(){var e=n.state.tripFilter,t=Object(v.a)(Object(v.a)(n)),r=t.populateLocations,a=t.filterRequestDates;n.selectedFilterFrom=[],n.selectedFilterTo=[],n.setState({tableLoading:!0,refreshIconHover:!1},Object(d.a)(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.fetchRideRequests().then(function(t){var l=t[0].data.results,i=t[1].data.results;i=a(i),l=a(l),Object(c.a)(l).concat(Object(c.a)(i)).forEach(function(e){e.key=e.link});var o=r(Object(c.a)(l).concat(Object(c.a)(i)),[]);n.setState({fetchedPassengerRequests:i,fetchedRideRequests:l,filteredTrips:"passenger"===e?i:l,locations:o.sort(),tableLoading:!1})});case 2:case"end":return t.stop()}},t,this)})))},n.filterRequestDates=function(e){return C.a.remove(e,function(e){return!E()(e.date,"YYYYY-MM-DD").isValid()||E()(e.date,"YYYYY-MM-DD").year()<E()(Date.now()).year()+4})},n.selectedFilterFrom=[],n.selectedFilterTo=[],n.refreshTimer=5,n.state={tripFilter:"ride",fetchedPassengerRequests:[],fetchedRideRequests:[],locations:[],filteredTrips:[],tableLoading:!0,refreshIconHover:!1,refreshIconClicked:!1,secondsUntilRefresh:5},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.filteredTrips,r=t.locations,l=t.tableLoading,i=t.refreshIconHover,c=t.refreshIconClicked,o=t.secondsUntilRefresh,h=this.handleFilterChange,u=this.onRadioChange,f=this.handleRefreshHoverEnter,m=this.handleRefreshHoverLeave,p=this.tripFilter,v=this.selectedFilterFrom,g=this.selectedFilterTo,E=this.handleRefreshClick;return a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement(y.a,{type:"flex",justify:"center"},a.a.createElement(b.a,{xs:24,md:20,lg:18,xl:14},a.a.createElement("h1",{style:{color:"yellow",borderBottom:"1px solid yellow"}},"Carpooling in Iceland"))),a.a.createElement(y.a,{type:"flex",justify:"center"},a.a.createElement(b.a,{xs:24,md:20,lg:18,xl:14},a.a.createElement(k.a.Group,{size:"large",onChange:u,defaultValue:"ride",buttonStyle:"solid",style:{verticalAlign:"top"}},a.a.createElement(R.a,{title:"Passengers seeking rides"},a.a.createElement(k.a.Button,{value:"ride",checked:"ride"===p},"Ride",a.a.createElement(x.a,{type:"car",style:{marginLeft:"6px"}}))),a.a.createElement(R.a,{title:"Drivers seeking passengers"},a.a.createElement(k.a.Button,{value:"passenger",checked:"passenger"===p},"Passengers",a.a.createElement(x.a,{type:"user-add",style:{marginLeft:"6px"}})))),a.a.createElement(R.a,{title:c?"Available to refresh in ".concat(o,"s"):"Refresh"},a.a.createElement(x.a,{type:"sync",spin:i,style:c?{float:"right",marginRight:"15px",cursor:"not-allowed"}:{float:"right",marginRight:"15px",cursor:"pointer"},onClick:E,onMouseEnter:f,onMouseLeave:m})))),a.a.createElement(y.a,{type:"flex",justify:"center"},a.a.createElement(b.a,{xs:12,md:10,lg:9,xl:7},a.a.createElement(w.a,{mode:"multiple",style:{width:"100%"},placeholder:"From",onChange:function(e){return h(e,"from")},value:v,allowClear:!0,maxTagCount:2,defaultValue:"All"},r.map(function(e){return a.a.createElement(w.a.Option,{key:e},e)}))),a.a.createElement(b.a,{xs:12,md:10,lg:9,xl:7},a.a.createElement(w.a,{mode:"multiple",style:{width:"100%"},placeholder:"To",onChange:function(e){return h(e,"to")},value:g,allowClear:!0,maxTagCount:2},r.map(function(e){return a.a.createElement(w.a.Option,{key:e},e)})))),a.a.createElement(y.a,{type:"flex",justify:"center"},a.a.createElement(b.a,{xs:24,md:20,lg:18,xl:14},a.a.createElement(F.a,{columns:H,dataSource:n,loading:l,style:{backgroundColor:"#e9ebee"},onRow:function(t){return{onMouseEnter:function(){var n=Object(d.a)(s.a.mark(function n(){return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.details){n.next=3;break}return n.next=3,I.fetchURL(t.link).then(function(n){t.details=D(n.data),e.forceUpdate()});case 3:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}()}}})))))}},{key:"componentDidMount",value:function(){this.fetchData()}}]),t}(r.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[270,2,1]]]);
//# sourceMappingURL=main.f513b9b7.chunk.js.map